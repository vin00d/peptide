---

title: Baseline Models


keywords: fastai
sidebar: home_sidebar



nb_path: "04_baseline_models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_baseline_models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">peptide.preprocessing.data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">peptide.preprocessing.embedding</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_train_df</span><span class="p">,</span> <span class="n">merged_test_df</span> <span class="o">=</span> <span class="n">get_all_data</span><span class="p">(</span><span class="n">merge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">acp_train_df</span><span class="p">,</span> <span class="n">acp_test_df</span><span class="p">,</span> <span class="n">amp_train_df</span><span class="p">,</span> <span class="n">amp_test_df</span><span class="p">,</span> <span class="n">dna_bind_train_df</span><span class="p">,</span> <span class="n">dna_bind_test_df</span> <span class="o">=</span> <span class="n">get_all_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acp_train_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sequence</th>
      <th>label_acp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RRWWRRWRRW</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GWKSVFRKAKKVGKTVGGLALDHYLG</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ALWKTMLKKLGTMALHAGKAALGAAADTISQGTQ</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GLFDVIKKVAAVIGGL</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>VAKLLAKLAKKVL</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acp_test_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sequence</th>
      <th>label_acp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FLPLLLSALPSFLCLVFKKC</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>DKLIGSCVWLAVNYTSNCNAECKRRGYKGGHCGSFLNVNCWCET</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AVKDTYSCFIMRGKCRHECHDFEKPIGFCTKLNANCYM</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GLPTCGETCFGGTCNTPGCTCDPWPVCTHN</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ENCGRQAG</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One-hot encode</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_features_ohe</span><span class="p">,</span> <span class="n">train_features_df</span><span class="p">,</span> <span class="n">train_df</span>  <span class="o">=</span> <span class="n">one_hot_encode</span><span class="p">(</span><span class="n">acp_train_df</span><span class="p">)</span>
<span class="n">test_features_ohe</span><span class="p">,</span> <span class="n">test_features_df</span><span class="p">,</span> <span class="n">test_df</span>  <span class="o">=</span> <span class="n">one_hot_encode</span><span class="p">(</span><span class="n">acp_test_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_features_ohe</span><span class="p">,</span> <span class="n">acp_train_df</span><span class="o">.</span><span class="n">label_acp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression()</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_features_ohe</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/Vinod/opt/anaconda3/envs/peptide/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.
Feature names unseen at fit time:
- 36_M
- 38_M
- 40_H
- 40_M
- 42_Y
- ...
Feature names seen at fit time, yet now missing:
- 0_N
- 13_M
- 16_M
- 24_M
- 26_W
- ...

  warnings.warn(message, FutureWarning)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/Vinod/code/myrepos/peptide/04_baseline_models.ipynb Cell 13&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/Vinod/code/myrepos/peptide/04_baseline_models.ipynb#ch0000018?line=0&#39;&gt;1&lt;/a&gt;</span> preds = lr.predict(test_features_ohe)

File <span class="ansi-green-fg">~/opt/anaconda3/envs/peptide/lib/python3.9/site-packages/sklearn/linear_model/_base.py:425</span>, in <span class="ansi-cyan-fg">LinearClassifierMixin.predict</span><span class="ansi-blue-fg">(self, X)</span>
<span class="ansi-green-intense-fg ansi-bold">    411</span> def predict(self, X):
<span class="ansi-green-intense-fg ansi-bold">    412</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    413</span>     Predict class labels for samples in X.
<span class="ansi-green-intense-fg ansi-bold">    414</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    423</span>         Vector containing the class labels for each sample.
<span class="ansi-green-intense-fg ansi-bold">    424</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 425</span>     scores = self.decision_function(X)
<span class="ansi-green-intense-fg ansi-bold">    426</span>     if len(scores.shape) == 1:
<span class="ansi-green-intense-fg ansi-bold">    427</span>         indices = (scores &gt; 0).astype(int)

File <span class="ansi-green-fg">~/opt/anaconda3/envs/peptide/lib/python3.9/site-packages/sklearn/linear_model/_base.py:407</span>, in <span class="ansi-cyan-fg">LinearClassifierMixin.decision_function</span><span class="ansi-blue-fg">(self, X)</span>
<span class="ansi-green-intense-fg ansi-bold">    387</span> &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    388</span> Predict confidence scores for samples.
<span class="ansi-green-intense-fg ansi-bold">    389</span> 
<span class="ansi-green-fg">   (...)</span>
<span class="ansi-green-intense-fg ansi-bold">    403</span>     this class would be predicted.
<span class="ansi-green-intense-fg ansi-bold">    404</span> &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">    405</span> check_is_fitted(self)
<span class="ansi-green-fg">--&gt; 407</span> X = self._validate_data(X, accept_sparse=&#34;csr&#34;, reset=False)
<span class="ansi-green-intense-fg ansi-bold">    408</span> scores = safe_sparse_dot(X, self.coef_.T, dense_output=True) + self.intercept_
<span class="ansi-green-intense-fg ansi-bold">    409</span> return scores.ravel() if scores.shape[1] == 1 else scores

File <span class="ansi-green-fg">~/opt/anaconda3/envs/peptide/lib/python3.9/site-packages/sklearn/base.py:585</span>, in <span class="ansi-cyan-fg">BaseEstimator._validate_data</span><span class="ansi-blue-fg">(self, X, y, reset, validate_separately, **check_params)</span>
<span class="ansi-green-intense-fg ansi-bold">    582</span>     out = X, y
<span class="ansi-green-intense-fg ansi-bold">    584</span> if not no_val_X and check_params.get(&#34;ensure_2d&#34;, True):
<span class="ansi-green-fg">--&gt; 585</span>     self._check_n_features(X, reset=reset)
<span class="ansi-green-intense-fg ansi-bold">    587</span> return out

File <span class="ansi-green-fg">~/opt/anaconda3/envs/peptide/lib/python3.9/site-packages/sklearn/base.py:400</span>, in <span class="ansi-cyan-fg">BaseEstimator._check_n_features</span><span class="ansi-blue-fg">(self, X, reset)</span>
<span class="ansi-green-intense-fg ansi-bold">    397</span>     return
<span class="ansi-green-intense-fg ansi-bold">    399</span> if n_features != self.n_features_in_:
<span class="ansi-green-fg">--&gt; 400</span>     raise ValueError(
<span class="ansi-green-intense-fg ansi-bold">    401</span>         f&#34;X has {n_features} features, but {self.__class__.__name__} &#34;
<span class="ansi-green-intense-fg ansi-bold">    402</span>         f&#34;is expecting {self.n_features_in_} features as input.&#34;
<span class="ansi-green-intense-fg ansi-bold">    403</span>     )

<span class="ansi-red-fg">ValueError</span>: X has 849 features, but LogisticRegression is expecting 958 features as input.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

